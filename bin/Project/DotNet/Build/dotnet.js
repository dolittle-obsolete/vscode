#!/usr/local/bin/node
'use strict';

var resolveProject = require('./resolveProject');
var spawn = require('child_process').spawn;

// Args:
// /root:RootDir / Place to put output files
// /t:Type of project running (free-text)
// /r - rerun
// /specsFor

var rerun = false;
var type = "default";
var rootDir = "";
var forTests = false;
var ignoreRewriteFolder = false;
var dotnetArguments = [];

process.argv.forEach(function (item, index) {
    if (index == 0) return;

    if (item.indexOf("/root:") == 0) {
        rootDir = item.substr(6);
    }
    if (item.indexOf("/type:") == 0) {
        type = item.substr(6);
    }
    if (item.indexOf("/rerun") == 0) {
        rerun = true;
    }
    if (item.indexOf("/ignoreRewriteFolder") == 0) {
        ignoreRewriteFolder = true;
    }
    if (item.indexOf("/forTests") == 0) {
        forTests = true;
    }
    if (item.indexOf("/arguments:") == 0) {
        var args = item.substr("/arguments:".length);
        if (args.indexOf("(") == 0) args = args.substr(1, args.length - 2);
        dotnetArguments = args.split(" ");
    }
});

if (rootDir.length == 0) {
    process.exit(1);
}

var project = resolveProject(rootDir, type, ignoreRewriteFolder, rerun, forTests);
dotnetArguments.push(project);

spawn("dotnet", dotnetArguments, { stdio: "inherit", stderr: "inherit" });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL1NvdXJjZS9Qcm9qZWN0L0RvdE5ldC9CdWlsZC9kb3RuZXQuanMiXSwibmFtZXMiOlsicmVzb2x2ZVByb2plY3QiLCJyZXF1aXJlIiwic3Bhd24iLCJyZXJ1biIsInR5cGUiLCJyb290RGlyIiwiZm9yVGVzdHMiLCJpZ25vcmVSZXdyaXRlRm9sZGVyIiwiZG90bmV0QXJndW1lbnRzIiwicHJvY2VzcyIsImFyZ3YiLCJmb3JFYWNoIiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsInN1YnN0ciIsImFyZ3MiLCJsZW5ndGgiLCJzcGxpdCIsImV4aXQiLCJwcm9qZWN0IiwicHVzaCIsInN0ZGlvIiwic3RkZXJyIl0sIm1hcHBpbmdzIjoiOztBQUVBLElBQU1BLGlCQUFpQkMsUUFBUSxrQkFBUixDQUF2QjtBQUNBLElBQU1DLFFBQVFELFFBQVEsZUFBUixFQUF5QkMsS0FBdkM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxJQUFJQyxRQUFRLEtBQVo7QUFDQSxJQUFJQyxPQUFPLFNBQVg7QUFDQSxJQUFJQyxVQUFVLEVBQWQ7QUFDQSxJQUFJQyxXQUFXLEtBQWY7QUFDQSxJQUFJQyxzQkFBc0IsS0FBMUI7QUFDQSxJQUFJQyxrQkFBa0IsRUFBdEI7O0FBRUFDLFFBQVFDLElBQVIsQ0FBYUMsT0FBYixDQUFxQixVQUFDQyxJQUFELEVBQU9DLEtBQVAsRUFBaUI7QUFDbEMsUUFBSUEsU0FBUyxDQUFiLEVBQWdCOztBQUVoQixRQUFJRCxLQUFLRSxPQUFMLENBQWEsUUFBYixLQUEwQixDQUE5QixFQUFpQztBQUM3QlQsa0JBQVVPLEtBQUtHLE1BQUwsQ0FBWSxDQUFaLENBQVY7QUFDSDtBQUNELFFBQUlILEtBQUtFLE9BQUwsQ0FBYSxRQUFiLEtBQTBCLENBQTlCLEVBQWlDO0FBQzdCVixlQUFPUSxLQUFLRyxNQUFMLENBQVksQ0FBWixDQUFQO0FBQ0g7QUFDRCxRQUFJSCxLQUFLRSxPQUFMLENBQWEsUUFBYixLQUEwQixDQUE5QixFQUFpQztBQUM3QlgsZ0JBQVEsSUFBUjtBQUNIO0FBQ0QsUUFBSVMsS0FBS0UsT0FBTCxDQUFhLHNCQUFiLEtBQXdDLENBQTVDLEVBQStDO0FBQzNDUCw4QkFBc0IsSUFBdEI7QUFDSDtBQUNELFFBQUlLLEtBQUtFLE9BQUwsQ0FBYSxXQUFiLEtBQTZCLENBQWpDLEVBQW9DO0FBQ2hDUixtQkFBVyxJQUFYO0FBQ0g7QUFDRCxRQUFJTSxLQUFLRSxPQUFMLENBQWEsYUFBYixLQUErQixDQUFuQyxFQUFzQztBQUNsQyxZQUFJRSxPQUFPSixLQUFLRyxNQUFMLENBQVksY0FBY0UsTUFBMUIsQ0FBWDtBQUNBLFlBQUlELEtBQUtGLE9BQUwsQ0FBYSxHQUFiLEtBQXFCLENBQXpCLEVBQTZCRSxPQUFPQSxLQUFLRCxNQUFMLENBQVksQ0FBWixFQUFlQyxLQUFLQyxNQUFMLEdBQWMsQ0FBN0IsQ0FBUDtBQUM3QlQsMEJBQWtCUSxLQUFLRSxLQUFMLENBQVcsR0FBWCxDQUFsQjtBQUNIO0FBQ0osQ0F2QkQ7O0FBeUJBLElBQUliLFFBQVFZLE1BQVIsSUFBa0IsQ0FBdEIsRUFBeUI7QUFDckJSLFlBQVFVLElBQVIsQ0FBYSxDQUFiO0FBQ0g7O0FBRUQsSUFBSUMsVUFBVXBCLGVBQWVLLE9BQWYsRUFBd0JELElBQXhCLEVBQThCRyxtQkFBOUIsRUFBbURKLEtBQW5ELEVBQTBERyxRQUExRCxDQUFkO0FBQ0FFLGdCQUFnQmEsSUFBaEIsQ0FBcUJELE9BQXJCOztBQUVBbEIsTUFBTSxRQUFOLEVBQWdCTSxlQUFoQixFQUFpQyxFQUFFYyxPQUFPLFNBQVQsRUFBb0JDLFFBQVEsU0FBNUIsRUFBakMiLCJmaWxlIjoiZG90bmV0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5cbmNvbnN0IHJlc29sdmVQcm9qZWN0ID0gcmVxdWlyZSgnLi9yZXNvbHZlUHJvamVjdCcpO1xuY29uc3Qgc3Bhd24gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuc3Bhd25cblxuLy8gQXJnczpcbi8vIC9yb290OlJvb3REaXIgLyBQbGFjZSB0byBwdXQgb3V0cHV0IGZpbGVzXG4vLyAvdDpUeXBlIG9mIHByb2plY3QgcnVubmluZyAoZnJlZS10ZXh0KVxuLy8gL3IgLSByZXJ1blxuLy8gL3NwZWNzRm9yXG5cbmxldCByZXJ1biA9IGZhbHNlO1xubGV0IHR5cGUgPSBcImRlZmF1bHRcIjtcbmxldCByb290RGlyID0gXCJcIjtcbmxldCBmb3JUZXN0cyA9IGZhbHNlO1xubGV0IGlnbm9yZVJld3JpdGVGb2xkZXIgPSBmYWxzZTtcbmxldCBkb3RuZXRBcmd1bWVudHMgPSBbXTtcblxucHJvY2Vzcy5hcmd2LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgaWYgKGluZGV4ID09IDApIHJldHVybjtcblxuICAgIGlmIChpdGVtLmluZGV4T2YoXCIvcm9vdDpcIikgPT0gMCkge1xuICAgICAgICByb290RGlyID0gaXRlbS5zdWJzdHIoNik7XG4gICAgfVxuICAgIGlmIChpdGVtLmluZGV4T2YoXCIvdHlwZTpcIikgPT0gMCkge1xuICAgICAgICB0eXBlID0gaXRlbS5zdWJzdHIoNik7XG4gICAgfVxuICAgIGlmIChpdGVtLmluZGV4T2YoXCIvcmVydW5cIikgPT0gMCkge1xuICAgICAgICByZXJ1biA9IHRydWU7XG4gICAgfVxuICAgIGlmIChpdGVtLmluZGV4T2YoXCIvaWdub3JlUmV3cml0ZUZvbGRlclwiKSA9PSAwKSB7XG4gICAgICAgIGlnbm9yZVJld3JpdGVGb2xkZXIgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoaXRlbS5pbmRleE9mKFwiL2ZvclRlc3RzXCIpID09IDApIHtcbiAgICAgICAgZm9yVGVzdHMgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoaXRlbS5pbmRleE9mKFwiL2FyZ3VtZW50czpcIikgPT0gMCkge1xuICAgICAgICBsZXQgYXJncyA9IGl0ZW0uc3Vic3RyKFwiL2FyZ3VtZW50czpcIi5sZW5ndGgpO1xuICAgICAgICBpZiggYXJncy5pbmRleE9mKFwiKFwiKSA9PSAwICkgYXJncyA9IGFyZ3Muc3Vic3RyKDEsIGFyZ3MubGVuZ3RoIC0gMik7XG4gICAgICAgIGRvdG5ldEFyZ3VtZW50cyA9IGFyZ3Muc3BsaXQoXCIgXCIpO1xuICAgIH1cbn0pO1xuXG5pZiAocm9vdERpci5sZW5ndGggPT0gMCkge1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbn1cblxubGV0IHByb2plY3QgPSByZXNvbHZlUHJvamVjdChyb290RGlyLCB0eXBlLCBpZ25vcmVSZXdyaXRlRm9sZGVyLCByZXJ1biwgZm9yVGVzdHMpO1xuZG90bmV0QXJndW1lbnRzLnB1c2gocHJvamVjdCk7XG5cbnNwYXduKFwiZG90bmV0XCIsIGRvdG5ldEFyZ3VtZW50cywgeyBzdGRpbzogXCJpbmhlcml0XCIsIHN0ZGVycjogXCJpbmhlcml0XCIgfSk7XG4iXX0=